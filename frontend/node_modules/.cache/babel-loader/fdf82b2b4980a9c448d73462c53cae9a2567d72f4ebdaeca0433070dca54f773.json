{"ast":null,"code":"import React,{createContext,useContext,useReducer,useEffect}from'react';import{authService}from'../services/authService';import{jsx as _jsx}from\"react/jsx-runtime\";const AuthContext=/*#__PURE__*/createContext();const initialState={user:null,token:localStorage.getItem('token'),isAuthenticated:false,loading:true,error:null};const authReducer=(state,action)=>{switch(action.type){case'LOGIN_START':return{...state,loading:true,error:null};case'LOGIN_SUCCESS':return{...state,user:action.payload.user,token:action.payload.token,isAuthenticated:true,loading:false,error:null};case'LOGIN_FAILURE':return{...state,loading:false,error:action.payload};case'LOGOUT':return{...state,user:null,token:null,isAuthenticated:false,loading:false,error:null};case'UPDATE_USER':return{...state,user:action.payload};case'SET_LOADING':return{...state,loading:action.payload};default:return state;}};export const AuthProvider=_ref=>{let{children}=_ref;const[state,dispatch]=useReducer(authReducer,initialState);useEffect(()=>{const initializeAuth=async()=>{const token=localStorage.getItem('token');if(token){try{const user=await authService.getCurrentUser();dispatch({type:'LOGIN_SUCCESS',payload:{user,token}});}catch(error){localStorage.removeItem('token');dispatch({type:'LOGOUT'});}}else{dispatch({type:'SET_LOADING',payload:false});}};initializeAuth();},[]);const login=async(email,password)=>{dispatch({type:'LOGIN_START'});try{const{user,token}=await authService.login(email,password);localStorage.setItem('token',token);dispatch({type:'LOGIN_SUCCESS',payload:{user,token}});return{success:true};}catch(error){dispatch({type:'LOGIN_FAILURE',payload:error.message});return{success:false,error:error.message};}};const register=async userData=>{dispatch({type:'LOGIN_START'});try{const{user,token}=await authService.register(userData);localStorage.setItem('token',token);dispatch({type:'LOGIN_SUCCESS',payload:{user,token}});return{success:true};}catch(error){dispatch({type:'LOGIN_FAILURE',payload:error.message});return{success:false,error:error.message};}};const logout=()=>{localStorage.removeItem('token');dispatch({type:'LOGOUT'});};const updateUser=userData=>{dispatch({type:'UPDATE_USER',payload:userData});};const value={...state,login,register,logout,updateUser};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:value,children:children});};export const useAuth=()=>{const context=useContext(AuthContext);if(!context){throw new Error('useAuth must be used within an AuthProvider');}return context;};","map":{"version":3,"names":["React","createContext","useContext","useReducer","useEffect","authService","jsx","_jsx","AuthContext","initialState","user","token","localStorage","getItem","isAuthenticated","loading","error","authReducer","state","action","type","payload","AuthProvider","_ref","children","dispatch","initializeAuth","getCurrentUser","removeItem","login","email","password","setItem","success","message","register","userData","logout","updateUser","value","Provider","useAuth","context","Error"],"sources":["C:/Users/gowth_tq3ir2j/OneDrive/Documents/project 3rd year/one credit/Fitness Tracker/frontend/src/context/AuthContext.js"],"sourcesContent":["import React, { createContext, useContext, useReducer, useEffect } from 'react';\nimport { authService } from '../services/authService';\n\nconst AuthContext = createContext();\n\nconst initialState = {\n  user: null,\n  token: localStorage.getItem('token'),\n  isAuthenticated: false,\n  loading: true,\n  error: null\n};\n\nconst authReducer = (state, action) => {\n  switch (action.type) {\n    case 'LOGIN_START':\n      return {\n        ...state,\n        loading: true,\n        error: null\n      };\n    case 'LOGIN_SUCCESS':\n      return {\n        ...state,\n        user: action.payload.user,\n        token: action.payload.token,\n        isAuthenticated: true,\n        loading: false,\n        error: null\n      };\n    case 'LOGIN_FAILURE':\n      return {\n        ...state,\n        loading: false,\n        error: action.payload\n      };\n    case 'LOGOUT':\n      return {\n        ...state,\n        user: null,\n        token: null,\n        isAuthenticated: false,\n        loading: false,\n        error: null\n      };\n    case 'UPDATE_USER':\n      return {\n        ...state,\n        user: action.payload\n      };\n    case 'SET_LOADING':\n      return {\n        ...state,\n        loading: action.payload\n      };\n    default:\n      return state;\n  }\n};\n\nexport const AuthProvider = ({ children }) => {\n  const [state, dispatch] = useReducer(authReducer, initialState);\n\n  useEffect(() => {\n    const initializeAuth = async () => {\n      const token = localStorage.getItem('token');\n      if (token) {\n        try {\n          const user = await authService.getCurrentUser();\n          dispatch({\n            type: 'LOGIN_SUCCESS',\n            payload: { user, token }\n          });\n        } catch (error) {\n          localStorage.removeItem('token');\n          dispatch({ type: 'LOGOUT' });\n        }\n      } else {\n        dispatch({ type: 'SET_LOADING', payload: false });\n      }\n    };\n\n    initializeAuth();\n  }, []);\n\n  const login = async (email, password) => {\n    dispatch({ type: 'LOGIN_START' });\n    try {\n      const { user, token } = await authService.login(email, password);\n      localStorage.setItem('token', token);\n      dispatch({\n        type: 'LOGIN_SUCCESS',\n        payload: { user, token }\n      });\n      return { success: true };\n    } catch (error) {\n      dispatch({\n        type: 'LOGIN_FAILURE',\n        payload: error.message\n      });\n      return { success: false, error: error.message };\n    }\n  };\n\n  const register = async (userData) => {\n    dispatch({ type: 'LOGIN_START' });\n    try {\n      const { user, token } = await authService.register(userData);\n      localStorage.setItem('token', token);\n      dispatch({\n        type: 'LOGIN_SUCCESS',\n        payload: { user, token }\n      });\n      return { success: true };\n    } catch (error) {\n      dispatch({\n        type: 'LOGIN_FAILURE',\n        payload: error.message\n      });\n      return { success: false, error: error.message };\n    }\n  };\n\n  const logout = () => {\n    localStorage.removeItem('token');\n    dispatch({ type: 'LOGOUT' });\n  };\n\n  const updateUser = (userData) => {\n    dispatch({\n      type: 'UPDATE_USER',\n      payload: userData\n    });\n  };\n\n  const value = {\n    ...state,\n    login,\n    register,\n    logout,\n    updateUser\n  };\n\n  return (\n    <AuthContext.Provider value={value}>\n      {children}\n    </AuthContext.Provider>\n  );\n};\n\nexport const useAuth = () => {\n  const context = useContext(AuthContext);\n  if (!context) {\n    throw new Error('useAuth must be used within an AuthProvider');\n  }\n  return context;\n}; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}